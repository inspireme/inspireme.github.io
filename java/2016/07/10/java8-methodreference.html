<!DOCTYPE html>
<html id="J-html" class="">
<head>
    <meta charset="UTF-8" />
    <title>
        
            Javaメソッド参照            
        
        (whisper's Programming MemoPage)
    </title>
    <meta name="generator" content="Jekyll" />
    <meta name="author" content="whisper" />
    <meta name="description" content="Javaのメソッド参照について。" />
    <meta name="keywords" content="java8 method reference" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" media="all" href="https://inspireme.github.io/static/style.css" />
	<link rel="stylesheet" type="text/css" media="all" href="https://inspireme.github.io/static/syntax.css" />
    <!--[if lt IE 9]>
    <script src="https://inspireme.github.io/static/js/html5.js" type="text/javascript"></script>
    <![endif]-->
    <script src="https://inspireme.github.io/static/js/jquery.js" type="text/javascript"></script>
</head>
<body itemscope itemtype="http://schema.org/WebPage" class="home blog lotus index">
    <nav class="lotus-nav">
        <ul>
            
            
            
            
            
            <li class="home ">
                <a href="/index.html" rel="bookmark" title="Home">
                    <i class="icon-home"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/categories.html" rel="bookmark" title="Categories">
                    <i class="icon-list-alt"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/archives.html" rel="bookmark" title="Archives">
                    <i class="icon-reorder"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/about.html" rel="bookmark" title="About Me">
                    <i class="icon-user"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="mailto:cndone@gmail.com" rel="bookmark" title="Contact Me">
                    <i class="icon-envelope-alt"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="https://github.com/inspireme" rel="bookmark" title="Github">
                    <i class="icon-github"></i>
                </a>
                
            </li>
            
        </ul>
    </nav>

    <p class="lotus-breadcrub">
    <a href="https://inspireme.github.io/index.html" rel="nofollow" rel="nofollow" title="ホームページ">Home</a>
    <span> &gt; </span>
    <a href="https://inspireme.github.io/archives.html" rel="nofollow" >Archives</a>
    <span> &gt; </span>
    Javaメソッド参照
</p>
<h1 class="lotus-pagetit">Javaメソッド参照</h1>

<p class="lotus-meta">Publish: <time class="date" pubdate="July 10, 2016">July 10, 2016</time></p>

<article  itemscope itemtype="http://schema.org/Article" class="lotus-post lotus-post-columns-1">
<p>メソッド参照は、JDK1.8で導入された構文。
関数型インターフェース（抽象メソッドが1つだけ定義されているインターフェース）の変数にメソッドそのものを代入することが出来る。<br />
※メソッド参照の形式は常に以下の２種となる。<br />
①クラス名::メソッド名(staticメソッド)<br />
②インスタンス変数名::メソッド名(インスタンスメソッド)<br /></p>

<ul>
  <li><a href="#1-ref">インスタンスメソッド</a></li>
  <li><a href="#2-ref">staticメソッド</a></li>
  <li><a href="#3-ref">親クラスとサブクラス</a></li>
  <li><a href="#4-ref">コンストラクター参照</a></li>
  <li><a href="#5-ref">各要注意点</a></li>
</ul>

<h4> <p id="1-ref">インスタンスメソッド</p></h4>
<hr />

<p>インスタンス変数名::メソッド名<br /></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Object1</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">contact</span><span class="o">(</span><span class="n">String</span> <span class="n">a</span><span class="o">,</span> <span class="n">String</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">getRandom</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">();</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">getText</span><span class="o">(</span><span class="n">String</span> <span class="n">prex</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">LocalDate</span> <span class="n">date1</span> <span class="o">=</span> <span class="n">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">prex</span> <span class="o">+</span> <span class="n">date1</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/***** 引数がなし ****/</span>
<span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"test"</span><span class="o">;</span>
<span class="n">IntSupplier</span> <span class="n">supplier</span> <span class="o">=</span> <span class="nl">str:</span><span class="o">:</span><span class="n">length</span><span class="o">;</span><span class="c1">// 参照メソッド</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">supplier</span><span class="o">.</span><span class="na">getAsInt</span><span class="o">());</span>

<span class="n">IntSupplier</span> <span class="n">supplier1</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">supplier1</span><span class="o">.</span><span class="na">getAsInt</span><span class="o">());</span><span class="c1">// ラムダ式</span>

<span class="n">IntSupplier</span> <span class="n">supplier2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntSupplier</span><span class="o">()</span> <span class="o">{</span><span class="c1">// 匿名クラス</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">getAsInt</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">};</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">supplier2</span><span class="o">.</span><span class="na">getAsInt</span><span class="o">());</span>

<span class="cm">/***** 引数が１個 ****/</span>
<span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">;</span><span class="c1">// 参照メソッド</span>
<span class="n">c</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="s">"テスト１"</span><span class="o">);</span>

<span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c2</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">);</span><span class="c1">// ラムダ式</span>
<span class="n">c2</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="s">"テスト２"</span><span class="o">);</span>

<span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span><span class="c1">// 匿名クラス</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">};</span>
<span class="n">c3</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="s">"テスト３"</span><span class="o">);</span>

<span class="cm">/***** 引数が２個 ****/</span>
<span class="n">Object1</span> <span class="n">obj1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object1</span><span class="o">();</span>
<span class="n">BinaryOperator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="nl">obj1:</span><span class="o">:</span><span class="n">contact</span><span class="o">;</span><span class="c1">// 参照メソッド</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="s">"abc"</span><span class="o">,</span> <span class="s">"123"</span><span class="o">));</span>

<span class="n">BinaryOperator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">b2</span> <span class="o">=</span> <span class="o">(</span><span class="n">str1</span><span class="o">,</span> <span class="n">str2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
	<span class="k">return</span> <span class="n">str1</span> <span class="o">+</span> <span class="n">str2</span><span class="o">;</span>
<span class="o">};</span><span class="c1">// ラムダ式</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b2</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="s">"abc"</span><span class="o">,</span> <span class="s">"123"</span><span class="o">));</span>

<span class="n">BinaryOperator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">b3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BinaryOperator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span><span class="c1">// 匿名クラス</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">apply</span><span class="o">(</span><span class="n">String</span> <span class="n">t</span><span class="o">,</span> <span class="n">String</span> <span class="n">u</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">t</span> <span class="o">+</span> <span class="n">u</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">};</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b3</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="s">"abc"</span><span class="o">,</span> <span class="s">"123"</span><span class="o">));</span></code></pre></figure>

<h4> <p id="2-ref">staticメソッド</p></h4>
<hr />

<p>クラス名::メソッド名<br /></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Object1</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">contact</span><span class="o">(</span><span class="n">String</span> <span class="n">a</span><span class="o">,</span> <span class="n">String</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">getRandom</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">();</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">getText</span><span class="o">(</span><span class="n">String</span> <span class="n">prex</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">LocalDate</span> <span class="n">date1</span> <span class="o">=</span> <span class="n">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">prex</span> <span class="o">+</span> <span class="n">date1</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/***** 引数がなし ****/</span>

<span class="n">DoubleSupplier</span> <span class="n">supplier</span> <span class="o">=</span> <span class="nl">Object1:</span><span class="o">:</span><span class="n">getRandom</span><span class="o">;</span><span class="c1">// 参照メソッド</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">supplier</span><span class="o">.</span><span class="na">getAsDouble</span><span class="o">());</span>

<span class="n">DoubleSupplier</span> <span class="n">supplier1</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">Object1</span><span class="o">.</span><span class="na">getRandom</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">supplier1</span><span class="o">.</span><span class="na">getAsDouble</span><span class="o">());</span><span class="c1">// ラムダ式</span>

<span class="n">DoubleSupplier</span> <span class="n">supplier2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DoubleSupplier</span><span class="o">()</span> <span class="o">{</span><span class="c1">// 匿名クラス</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">double</span> <span class="nf">getAsDouble</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">};</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">supplier2</span><span class="o">.</span><span class="na">getAsDouble</span><span class="o">());</span>

<span class="cm">/***** 引数が１個 ****/</span>
<span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="nl">Object1:</span><span class="o">:</span><span class="n">getText</span><span class="o">;</span><span class="c1">// 参照メソッド</span>
<span class="n">c</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="s">"テスト１"</span><span class="o">);</span>

<span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c2</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
	<span class="n">LocalDate</span> <span class="n">date1</span> <span class="o">=</span> <span class="n">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">date1</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
<span class="o">};</span><span class="c1">// ラムダ式</span>
<span class="n">c2</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="s">"テスト２"</span><span class="o">);</span>

<span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span><span class="c1">// 匿名クラス</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">LocalDate</span> <span class="n">date1</span> <span class="o">=</span> <span class="n">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">date1</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
	<span class="o">}</span>
<span class="o">};</span>
<span class="n">c3</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="s">"テスト３"</span><span class="o">);</span>

<span class="cm">/***** 引数が２個 ****/</span>
<span class="n">IntBinaryOperator</span> <span class="n">b</span> <span class="o">=</span> <span class="nl">Integer:</span><span class="o">:</span><span class="n">sum</span><span class="o">;</span><span class="c1">// 参照メソッド</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">applyAsInt</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="mi">200</span><span class="o">));</span>

<span class="n">IntBinaryOperator</span> <span class="n">b2</span> <span class="o">=</span> <span class="o">(</span><span class="n">str1</span><span class="o">,</span> <span class="n">str2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
	<span class="k">return</span> <span class="n">str1</span> <span class="o">+</span> <span class="n">str2</span><span class="o">;</span>
<span class="o">};</span><span class="c1">// ラムダ式</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b2</span><span class="o">.</span><span class="na">applyAsInt</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="mi">200</span><span class="o">));</span>

<span class="n">IntBinaryOperator</span> <span class="n">b3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntBinaryOperator</span><span class="o">()</span> <span class="o">{</span><span class="c1">// 匿名クラス</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">applyAsInt</span><span class="o">(</span><span class="kt">int</span> <span class="n">t</span><span class="o">,</span> <span class="kt">int</span> <span class="n">u</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">t</span> <span class="o">+</span> <span class="n">u</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">};</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b3</span><span class="o">.</span><span class="na">applyAsInt</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="mi">200</span><span class="o">));</span></code></pre></figure>

<h4> <p id="3-ref">親クラスとサブクラス</p></h4>
<hr />

<p>メソッド参照はラムダ式と同義なので、明示的に「クラス名::メソッド名」の形式で指定しても、対象自体のインスタンスのクラスのメソッドが呼ばれる</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">checkNew</span><span class="o">()</span> <span class="o">{</span>
<span class="cm">/**
 * メソッド参照はラムダ式と同義なので、明示的に「クラス名::メソッド名」の形式で指定しても、対象自体のインスタンスのクラスのメソッドが呼ばれる
 *
 */</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Checker</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="k">new</span> <span class="n">Checker</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="k">new</span> <span class="n">Checker</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="k">new</span> <span class="n">Checker</span><span class="o">(</span><span class="mi">3</span><span class="o">),</span> <span class="k">new</span> <span class="n">SubChecker</span><span class="o">(</span><span class="mi">3</span><span class="o">),</span>
		<span class="k">new</span> <span class="nf">SubChecker</span><span class="o">(</span><span class="mi">4</span><span class="o">),</span> <span class="k">new</span> <span class="n">SubChecker</span><span class="o">(</span><span class="mi">5</span><span class="o">));</span>
<span class="c1">// ラムダ式で指定</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">checker</span> <span class="o">-&gt;</span> <span class="n">checker</span><span class="o">.</span><span class="na">check</span><span class="o">()).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()));</span>

<span class="c1">// メソッド参照で指定</span>
<span class="c1">// ×System.out.println(list.stream().filter(SubChecker::check).collect(Collectors.toList()));//コンパイルエラー</span>

<span class="c1">// ラムダ式で親クラスを指定といっても</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">((</span><span class="n">Checker</span> <span class="n">check</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">check</span><span class="o">.</span><span class="na">check</span><span class="o">()).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()));</span>

<span class="c1">// メソッド参照で親クラスを指定といっても</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="nl">Checker:</span><span class="o">:</span><span class="n">check</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()));</span>

<span class="o">}</span>

<span class="err">実行結果：↓</span>

<span class="o">[</span><span class="n">com</span><span class="o">.</span><span class="na">whisper</span><span class="o">.</span><span class="na">methodref</span><span class="o">.</span><span class="na">Checker</span><span class="o">.</span><span class="mi">2</span><span class="o">,</span> <span class="n">com</span><span class="o">.</span><span class="na">whisper</span><span class="o">.</span><span class="na">methodref</span><span class="o">.</span><span class="na">SubChecker</span><span class="o">.</span><span class="mi">5</span><span class="o">]</span>
<span class="o">[</span><span class="n">com</span><span class="o">.</span><span class="na">whisper</span><span class="o">.</span><span class="na">methodref</span><span class="o">.</span><span class="na">Checker</span><span class="o">.</span><span class="mi">2</span><span class="o">,</span> <span class="n">com</span><span class="o">.</span><span class="na">whisper</span><span class="o">.</span><span class="na">methodref</span><span class="o">.</span><span class="na">SubChecker</span><span class="o">.</span><span class="mi">5</span><span class="o">]</span>
<span class="o">[</span><span class="n">com</span><span class="o">.</span><span class="na">whisper</span><span class="o">.</span><span class="na">methodref</span><span class="o">.</span><span class="na">Checker</span><span class="o">.</span><span class="mi">2</span><span class="o">,</span> <span class="n">com</span><span class="o">.</span><span class="na">whisper</span><span class="o">.</span><span class="na">methodref</span><span class="o">.</span><span class="na">SubChecker</span><span class="o">.</span><span class="mi">5</span><span class="o">]</span></code></pre></figure>

<h4> <p id="4-ref">コンストラクター参照</p></h4>
<hr />

<p>クラス名::new</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">IntFunction</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">String</span><span class="o">[]::</span><span class="k">new</span><span class="o">;</span><span class="c1">//メソッド参照</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>

<span class="n">IntFunction</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;</span> <span class="n">factory1</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">n</span><span class="o">];</span><span class="c1">//ラムダ式</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">array1</span> <span class="o">=</span> <span class="n">factory1</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>

<span class="n">IntFunction</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;</span> <span class="n">factory2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntFunction</span><span class="o">&lt;</span><span class="n">String</span><span class="o">[]&gt;()</span> <span class="o">{</span><span class="c1">//匿名クラス</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">apply</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">value</span><span class="o">];</span>
	<span class="o">}</span>
<span class="o">};</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">array3</span> <span class="o">=</span> <span class="n">factory2</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span></code></pre></figure>

<h4> <p id="5-ref">各要注意点</p></h4>
<hr />

<ul>
  <li>this</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MethodReference4Special</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">method2</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="mi">123</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">method4</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="mi">1234</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method1</span><span class="o">()</span> <span class="o">{</span><span class="c1">// 自分自身のクラスにあるインスタンスメソッドを渡す場合は、「this::」を付ける</span>
		<span class="n">IntSupplier</span> <span class="n">supplier</span> <span class="o">=</span> <span class="k">this</span><span class="o">::</span><span class="n">method2</span><span class="o">;</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">supplier</span><span class="o">.</span><span class="na">getAsInt</span><span class="o">());</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">method3</span><span class="o">()</span> <span class="o">{</span><span class="c1">// 自分自身のクラスにあるstaticメソッドを渡す場合は、「自クラス名::」を付ける</span>
		<span class="n">IntSupplier</span> <span class="n">supplier</span> <span class="o">=</span> <span class="nl">MethodReference4Special:</span><span class="o">:</span><span class="n">method4</span><span class="o">;</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">supplier</span><span class="o">.</span><span class="na">getAsInt</span><span class="o">());</span>
	<span class="o">}</span>
<span class="o">}</span>	</code></pre></figure>

<ul>
  <li>インスタンスメソッドを渡す際に「クラス名::」を使っている</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**
 * 引数が2つ（A a, B b）ある関数を渡す場合、 「a.method(b)」という呼び出しになるなら、
 * 「A::method」という形でクラス名を用いたメソッド参照が渡せる。
 */</span>
<span class="n">BiFunction</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;::</span><span class="n">add</span><span class="o">;</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="s">"abc"</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>

<span class="c1">// ラムダ式を使ってもメソッド参照を使っても同じ結果が出力されている。</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">BiFunction</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">f2</span> <span class="o">=</span> <span class="o">(</span><span class="n">list2</span><span class="o">,</span> <span class="n">s</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">list2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
<span class="n">f2</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">list1</span><span class="o">,</span> <span class="s">"abc"</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span></code></pre></figure>

<ul>
  <li>曖昧なメソッド参照</li>
</ul>

<p>構文上はstaticメソッドでもインスタンスメソッドでも指定できるが、使用時に一意に決定できない場合（曖昧な場合）はコンパイルエラーになる。</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Object2</span> <span class="o">{</span>
	<span class="kd">protected</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">value</span><span class="o">;</span>
	<span class="kd">public</span> <span class="nf">Object2</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span>  <span class="mi">0</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="nf">Object2</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="c1">// インスタンスメソッドのisOk</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isOk</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="c1">// staticメソッドのisOk</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isOk</span><span class="o">(</span><span class="n">Object2</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="na">value</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Object2</span> <span class="n">obj2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object2</span><span class="o">();</span>
<span class="n">IntPredicate</span> <span class="n">p</span> <span class="o">=</span> <span class="n">value</span> <span class="o">-&gt;</span> <span class="n">Object2</span><span class="o">.</span><span class="na">isOk</span><span class="o">(</span><span class="n">obj2</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">test</span><span class="o">(</span><span class="mi">5</span><span class="o">));</span>

<span class="n">BooleanSupplier</span> <span class="n">b</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">obj2</span><span class="o">.</span><span class="na">isOk</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">getAsBoolean</span><span class="o">());</span>

<span class="c1">//×　Predicate&lt;Object2&gt; p2 = obj2::isOk;//The method isOk(Object2) from the type Object2 should be accessed in a static</span>

<span class="c1">//×　Predicate&lt;Object2&gt; p2 = Object2::isOk;//Ambiguous method reference: both isOk() and isOk(Object2) from the type Object2 are eligible</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Object2</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">mapToObj</span><span class="o">(</span><span class="nl">Object2:</span><span class="o">:</span><span class="k">new</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>

<span class="c1">// ラムダ式によるインスタンスメソッド呼び出し</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">value</span> <span class="o">-&gt;</span> <span class="n">value</span><span class="o">.</span><span class="na">isOk</span><span class="o">()).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()));</span>

<span class="c1">// ラムダ式によるstaticメソッド呼び出し</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">value</span> <span class="o">-&gt;</span> <span class="n">Object2</span><span class="o">.</span><span class="na">isOk</span><span class="o">(</span><span class="n">value</span><span class="o">)).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()));</span>

<span class="c1">// メソッド参照→コンパイルエラー</span>
<span class="c1">//×　System.out.println(list.stream().filter(Value::isOk).collect(Collectors.toList()));</span></code></pre></figure>

<ul>
  <li>ジェネリクス</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">methodG</span><span class="o">(</span><span class="n">T</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span><span class="c1">//ジェネリクス</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">arg</span><span class="o">);</span>

<span class="o">}</span>
<span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="nl">MethodReference4Special:</span><span class="o">:&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="n">methodG</span><span class="o">;</span><span class="c1">// 引数型を明示的に指定したい場合、「::」の直後に「&lt;型引数&gt;」を指定する</span>
<span class="n">c</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="s">"111"</span><span class="o">);</span></code></pre></figure>


</article>
	
<p class="lotus-anno">Disclaimer: This article is based on  <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="nofollow" target="_blank" title="表示-非営利-継承">BY-NC-SA</a> license. Reproduced please specify switched from: <a href="" title="" rel="nofollow">whisper</a></p>
    
<section class="lotus-nextpage fn-clear">
    
    <div class="lotus-nextpage-left"><a class="prev" href="/java/2016/07/05/java8-lambda.html" rel="prev">&laquo;&nbsp;Javaラムダ式</a></div>
    
    
</section>


<footer class="lotus-footer">
	<p>Copyright © 2011–2016 whisper All rights reserved. Design by <a href="http://www.zhanxin.info" target="_blank">zhanxin</a>.</p>
</footer>
<script src="https://inspireme.github.io/static/js/jquery.scrollTo.js" type="text/javascript"></script>
<script src="https://inspireme.github.io/static/js/iLotus.js" type="text/javascript"></script>
</body>
</html>
